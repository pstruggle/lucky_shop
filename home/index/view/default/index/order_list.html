{include file="base/header" /}
<!--header-->
<header>
    <a href="javascript:history.go(-1);" class="iconfont backIcon">&#60;</a>
    <h1>订单列表</h1>
</header>
<div style="height:1rem;"></div>
<!--异步处理，此处不做TAB形式,注意当前状态样式currStyle-->
<aside class="orderType">
    <a href="javascript:void(0);" data-type="0" class="currStyle" >商城订单</a>
    <a href="javascript:void(0);" data-type="1">旅游订单</a>
    <a href="javascript:void(0);" data-type="2" >门票订单</a>
    <a href="javascript:void(0);" data-type="3" >签证订单</a>
</aside>
<aside class="orderSift">
    <a href="javascript:void(0);" data-type="0" class="currStyle" >全部订单</a>
    <a href="javascript:void(0);" data-type="1">待付款</a>
    <a href="javascript:void(0);" data-type="2" >待确认</a>
    <a href="javascript:void(0);" data-type="3" >已确认</a>
</aside>
<!--订单列表-->
<ul class="orderList">
    <!--订单循环li-->

</ul>
<style>
    .order_details{
        background-color: #00ADB2;
        color: white;
    }
    .orderType{
        height: .85rem;
        line-height: .85rem;
        display: box;
        display: -webkit-box;
        display: -moz-box;
        padding: 0 3%;
        background: white;
        background: white;
        text-align: center;
    }
    .orderType .currStyle {
        color: #0C0;
        border-bottom: 1px #0c0 solid;
    }
    .orderType a {
        display: block;
        box-flex: 1;
        -webkit-box-flex: 1;
        -moz-box-flex: 1;
    }
</style>
{include file="base/footer" /}
<script>
    $(function(){
        var class_a = 0,
            urls = ["{:url('Mall/ajax_order')}","{:url('Index/ajax_order')}","{:url('Ticket/ajax_order')}","{:url('Visa/ajax_order')}"];
        $('.orderSift a').click(otype);
        function otype() {
            var a = $(this);
            var type = a.data('type') || 0;
            var data = {'type':type};
            a.addClass('currStyle').siblings('a').removeClass('currStyle');
            $.get(urls[class_a],data,function (data) {
//                var data = eval('('+data+')');
                console.log(urls[class_a],class_a);
                $('.orderList').html(data);
            });
        }
        $('.orderType a').click(oClass);
        oClass();
        function oClass() {
            var a = $(this);
            class_a = a.data('type') || 0;
            a.addClass('currStyle').siblings('a').removeClass('currStyle');
            otype();
        }
        var payurls = ['{:url("Mall/confirm_order")}','{:url("Index/order")}','{:url("Ticket/order_pay")}','{:url("Visa/order_pay")}'],
            getStr = ['?oid=','?shopid=','?oid=','?oid='];
        //付款
        $('.orderList').on('click','.order_payBtn',function(){
            var payurl = payurls[class_a];
            var oid = $(this).data('id');
            location.href = payurl+getStr[class_a]+oid;
        });
        var delurls = ['{:url("Mall/order_del")}','{:url("Index/order_del")}','{:url("Ticket/order_del")}','{:url("Visa/order_del")}'];
        //删除订单
        $('.orderList').on('click','.order_delBtn',function(){
            var payurl = delurls[class_a];
            var oid = $(this).data('id');
            location.href = payurl+getStr[class_a]+oid;
        });
        //查看订单
        $('.orderList').on('click','.order_details',function(){
//            var payurl = '{:url("Index/confirm_order")}';
//            var oid = $(this).data('id');
//            location.href = payurl+'?oid='+oid;
        });
        //评论订单
        $('.orderList').on('click','.order_conBtn',function(){
            var payurl = '{:url("Index/comment")}';
            var oid = $(this).data('id');
            location.href = payurl + '?oid='+oid+'&type='+class_a;
        });
    });
</script>

